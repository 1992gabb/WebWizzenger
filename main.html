<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<link rel="stylesheet" type="text/css" href="css/style.css">
        <title>Wizzenger</title>
		<script src="js/general.js"></script>
		<script src="js/Models/Conversation.js"></script>
		<script src="js/Models/Contact.js"></script>
		<script src="js/Models/Message.js"></script>
		<script src="js/Models/User.js"></script>
	</head>
	
	

	<script src="https://www.gstatic.com/firebasejs/4.12.0/firebase.js"></script>
	<script type="text/javascript" src="js/firebase.js"></script>
	<script>
		window.onload = () => {
			firebase.auth().onAuthStateChanged(function(user) {
					if (user) {
						currentUser = user;
					} else {
						document.location.href="index.html";
					}
			});

			readConvos();

			document.getElementById("default").click();
			document.getElementById("message_content").onkeyup = function(event){
				var key = event.keyCode;

				// If the user has pressed enter
				if (key === 13) {
					sendMessage(1);
				}
			}
			document.getElementById("ic_info").onclick = function(event){
				if(document.getElementById("p_title").innerHTML != "Sélectionnez une conversation pour commencer!"){
					afficherContact(document.getElementById("p_title").innerHTML);
				}
				
			}
		}
	</script>

	<script type="text/javascript" src="js/mainFunctions.js"></script>

	<body id = "main_body">
		<div id = "zone_browsing">
			<header id = "main_header">
					<button id = "button_logout" onclick="logout()">Sortir</button>
				<p style="text-align:center;">Wizzenger</p>
			</header>
			<div id = "zone_recherche">
				<p style="text-align:center;">Zone Recherche</p>
			</div>

			<div id = "zone_titles">
				<div id="titles_tab_titles">
  					<button class="tab_links" onclick="openTab(event, 'zone_convos')" id ="default">Conversations</button>
					<button class="tab_links" onclick="openTab(event, 'zone_contacts')">Contacts</button>
				</div>
			</div>

			<div id = "zone_convos" class = "tab_content">
				<!-- Populé par le code javascript (voir readConvos) -->
			</div>

			<div id = "zone_contacts" class = "tab_content">
				<!-- Populé par le code javascript (voir readContacts) -->
			</div>
		</div>

		<div id = "zone_selectedConvo">
			<div id = "selectedConvo_title">
				<p id="p_title" style="width:50%;float:left;">Sélectionnez une conversation pour commencer!</p>
				<img src="images/ic_info.png" alt="bouton paramètres" id = "ic_info">
				<img src="images/settings.png" alt="bouton paramètres" id = "ic_settings">
			</div>

			<div id = "selectedConvo_messages">
				<!-- Populé par le code javascript (voir afficherConvo) -->

			</div>

			<div id = "selectedContactInfo">
				<!-- Populé par le code javascript (voir afficherContact) -->
				<img id = "selectedContact_avatar" src = "images/default_avatar.png">
				<div id= "selectedContact_email">Courriel: </div>
				<div id= "selectedContact_phone">Téléphone: </div>
				<div id="selectedContact_removeZone">
					<p style = "float:left;line-height:50px;">Retirer le contact: </p>
					<img id = "selectedContact_removeButton" src="images/button_remove.png" alt="remove button">
				</div>

			</div>

			<div id = "selectedConvo_writeSend">
				<div id = "selectedConvo_entryZone">
					<textarea name="message_content" id ="message_content" cols="210" rows="1" style = "width:100%;height:100%;line-height:60px;"></textarea>

				</div>
				<button id = "button_wizz" onclick="sendWizz()"></button>
				<button id = "button_send" onclick="sendMessage(0)"></button>
			</div>
		</div>
		<footer>Tous Droits Réservés.                Créé par Gabriel Bombardier                  10 Février 2018</footer>
	</body>
</html>